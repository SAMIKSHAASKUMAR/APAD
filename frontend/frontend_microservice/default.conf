'''server {
  listen 80;
  server_name localhost;

  root /usr/share/nginx/html;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }

  # --- API Proxy for User Service ---
  location /api/user/ {
    # Set the upstream URL as a variable.
    # Nginx won't''' check this host at startup.
    set $upstream_userservice http://user-service:8001;
    
    # Use the variable here.
    proxy_pass $upstream_userservice;

    # Standard proxy headers
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }

  # --- API Proxy for Project Service ---
  location /api/project/ {
    set $upstream_projectservice http://project-service:8002;
    proxy_pass $upstream_projectservice;

    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }

  # --- API Proxy for Inventory Service ---
  location /api/inventory/ {
    set $upstream_inventoryservice http://inventory-service:8003;
    proxy_pass $upstream_inventoryservice;

    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }
}'''

server {
  listen 80;
  server_name localhost;

  root /usr/share/nginx/html;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }

  # --- API Proxy for User Service ---
  # This rule will catch a request for "/api/user/login"
  # and forward it to "http://user-service:8001/shecodes/login"
  location /api/user/ {
    set $upstream_userservice http://user-service:8001;
    # This path is now correct:
    proxy_pass $upstream_userservice/shecodes/; 
  }

  # --- API Proxy for Project Service ---
  # This rule will catch "/api/project/createproject"
  # and forward it to "http://project-service:8002/shecodes/projects/createproject"
  location /api/project/ {
    set $upstream_projectservice http://project-service:8002;
    # (Assuming this is your project path, based on our last chat)
    proxy_pass $upstream_projectservice/shecodes/projects/;
  }

  # --- API Proxy for Inventory Service ---
  # (Assuming this is your inventory path)
  location /api/inventory/ {
    set $upstream_inventoryservice http://inventory-service:8003;
    proxy_pass $upstream_inventoryservice/shecodes/inventory/;
  }
}